<div class="verdict-form-page">
  <h2 class="page-title">Unos podataka o sluƒçaju</h2>

  <!-- Metapodaci -->
  <div class="form-wrapper-left">
    <div class="form-section">
      <h3>Osnovni podaci:</h3>
      <label></label>
      <label>Naziv predmeta:*</label>
      <input [(ngModel)]="metadata.caseName" name="caseName" pattern="^G_\d{1,3}-\d{1,4}$" #caseName="ngModel"
        placeholder="G_123-1234">

      <label>Datum:*</label>
      <input type="date" [(ngModel)]="metadata.date" name="date" [max]="today" required>

      <label>Sud:*</label>
      <input [(ngModel)]="metadata.court" name="court" required>

      <label>Sudija:*</label>
      <input [(ngModel)]="metadata.judge" name="judge" required>

      <label>Zapisniƒçar:*</label>
      <input [(ngModel)]="metadata.clerk" name="clerk" required>

      <label>Optu≈æeni:*</label>
      <input [(ngModel)]="metadata.defendant" name="defendant" required>

      <label>O≈°teƒáeni:*</label>
      <input [(ngModel)]="metadata.injuredParty" name="injuredParty" required>

      <label>Tu≈æilac:</label>
      <input [(ngModel)]="metadata.prosecutorAttorney" name="prosecutorAttorney">

      <label>Branilac:</label>
      <input [(ngModel)]="metadata.defenseAttorney" name="defenseAttorney">

      <label>Pravni zastupnik:</label>
      <input [(ngModel)]="metadata.legalRepresentative" name="legalRepresentative">

      <label>Vje≈°tak:</label>
      <input [(ngModel)]="metadata.expert" name="expert">

      <label>Uƒçesnici:</label>
      <input [(ngModel)]="metadata.participants" name="participants">

      <label>Organizacije:</label>
      <input [(ngModel)]="metadata.organizations" name="organizations">

    </div>
  </div>



  <!-- Atributi -->
  <div class="form-wrapper-right">
    <div class="form-section">
      <h3>Pravne ƒçinjenice:</h3>

      <label>
        <input type="checkbox" [(ngModel)]="attributes.acknowledged"> Priznao
      </label>

      <label>
        <input type="checkbox" [(ngModel)]="attributes.convicted"> Osuƒëivan
      </label>

      <label>
        <input type="checkbox" [(ngModel)]="attributes.maintenance"> Izdr≈æavanje ƒçlanova porodice
      </label>

      <label>
        <input type="checkbox" [(ngModel)]="attributes.repentance"> Kajanje
      </label>

      <label>
        <input type="checkbox" [(ngModel)]="attributes.previousFamilyIssues"> Porodiƒçni problemi
      </label>

      <label>
        <input type="checkbox" [(ngModel)]="attributes.correctBehavior"> Korektno dr≈æanje
      </label>

      <label>
        <input type="checkbox" [(ngModel)]="attributes.injuredCriminalProsecution"> O≈°teƒáeni goni kriviƒçno
      </label>

      <label>
        <input type="checkbox" [(ngModel)]="attributes.propertyClaim"> Imovinsko-pravni zahtjev
      </label>

      <label>
        <input type="checkbox" [(ngModel)]="attributes.intentional"> Sa umi≈°ljajem
      </label>

      <label>Materijalno stanje:</label>
      <select id="financialStatus" [(ngModel)]="attributes.financialStatus" class="form-select">
        <option value="Dobro">Dobro</option>
        <option value="Srednje">Srednje</option>
        <option value="Lose">Lose</option>
      </select>

      <label>Tip povrede:</label>
      <select id="injuryType" [(ngModel)]="attributes.injuryType" class="form-select">
        <option value="Nema">Nema</option>
        <option value="Lake">Lake</option>
        <option value="Srednje">Srednje</option>
        <option value="Teske">Teske</option>
        <option value="Dusevne">Dusevne</option>
      </select>

      <label>Uraƒçunljivost:</label>
      <select id="accountability" [(ngModel)]="attributes.accountability" class="form-select">
        <option value="Uracunljiv">Uracunljiv</option>
        <option value="Smanjena uracunljivost">Smanjena uracunljivost</option>
        <option value="Neuracunljiv">Neuracunljiv</option>
      </select>


      <!-- Rasudjivanje po pravilima -->
      <div class="section-separator">
        <hr style="margin: 20px 0; border: 1px solid #ccc;">
        <h3 style="margin: 15px 0; color: #ffffff; font-weight: bold;">Rasuƒëivanje po pravilima</h3>
      </div>

      <!-- Article 221 -->
      <label>Nedavanje izdr≈æavanja:</label>
      <div class="custom-dropdown">
        <button type="button" class="dropdown-toggle" (click)="toggleDropdown('article221')">
          <span>{{ selectedConditions.article221.length > 0 ? selectedConditions.article221.length + ' izabrano' :
            'Izaberite uslove...' }}</span>
          <span class="arrow" [class.open]="dropdownStates.article221">‚ñº</span>
        </button>
        <div class="dropdown-options" *ngIf="dropdownStates.article221">
          <div *ngFor="let option of articleOptions.article221" class="dropdown-option"
            (click)="toggleOption('article221', option.value)">
            <input type="checkbox" [checked]="selectedConditions.article221.includes(option.value)">
            <span>{{ option.label }}</span>
          </div>
        </div>
      </div>

      <!-- Article 222 -->
      <label>Kr≈°enje porodiƒçnih obaveza:</label>
      <div class="custom-dropdown">
        <button type="button" class="dropdown-toggle" (click)="toggleDropdown('article222')">
          <span>{{ selectedConditions.article222.length > 0 ? selectedConditions.article222.length + ' izabrano' :
            'Izaberite uslove...' }}</span>
          <span class="arrow" [class.open]="dropdownStates.article222">‚ñº</span>
        </button>
        <div class="dropdown-options" *ngIf="dropdownStates.article222">
          <div *ngFor="let option of articleOptions.article222" class="dropdown-option"
            (click)="toggleOption('article222', option.value)">
            <input type="checkbox" [checked]="selectedConditions.article222.includes(option.value)">
            <span>{{ option.label }}</span>
          </div>
        </div>
      </div>

      <!-- Article 216 -->
      <label>Vanbraƒçna zajednica sa maloletnikom:</label>
      <div class="custom-dropdown">
        <button type="button" class="dropdown-toggle" (click)="toggleDropdown('article216')">
          <span>{{ selectedConditions.article216.length > 0 ? selectedConditions.article216.length + ' izabrano' :
            'Izaberite uslove...' }}</span>
          <span class="arrow" [class.open]="dropdownStates.article216">‚ñº</span>
        </button>
        <div class="dropdown-options" *ngIf="dropdownStates.article216">
          <div *ngFor="let option of articleOptions.article216" class="dropdown-option"
            (click)="toggleOption('article216', option.value)">
            <input type="checkbox" [checked]="selectedConditions.article216.includes(option.value)">
            <span>{{ option.label }}</span>
          </div>
        </div>
      </div>

      <!-- Article 217 -->
      <label>Oduzimanje deteta:</label>
      <div class="custom-dropdown">
        <button type="button" class="dropdown-toggle" (click)="toggleDropdown('article217')">
          <span>{{ selectedConditions.article217.length > 0 ? selectedConditions.article217.length + ' izabrano' :
            'Izaberite uslove...' }}</span>
          <span class="arrow" [class.open]="dropdownStates.article217">‚ñº</span>
        </button>
        <div class="dropdown-options" *ngIf="dropdownStates.article217">
          <div *ngFor="let option of articleOptions.article217" class="dropdown-option"
            (click)="toggleOption('article217', option.value)">
            <input type="checkbox" [checked]="selectedConditions.article217.includes(option.value)">
            <span>{{ option.label }}</span>
          </div>
        </div>
      </div>

      <!-- Article 220 -->
      <label>Nasilje u porodici:</label>
      <div class="custom-dropdown">
        <button type="button" class="dropdown-toggle" (click)="toggleDropdown('article220')">
          <span>{{ selectedConditions.article220.length > 0 ? selectedConditions.article220.length + ' izabrano' :
            'Izaberite uslove...' }}</span>
          <span class="arrow" [class.open]="dropdownStates.article220">‚ñº</span>
        </button>
        <div class="dropdown-options" *ngIf="dropdownStates.article220">
          <div *ngFor="let option of articleOptions.article220" class="dropdown-option"
            (click)="toggleOption('article220', option.value)">
            <input type="checkbox" [checked]="selectedConditions.article220.includes(option.value)">
            <span>{{ option.label }}</span>
          </div>
        </div>
      </div>


    </div>


    <!-- treca kolona: prijedlozi slicnih presuda i ispod dodati rezultate rasudjivanja po pravilima-->
    <div>
      <div class="form-wrapper-right scrollable-column">
        Sliƒçne presude:
        <ul class="verdict-list" *ngIf="similarVerdicts$ | async as verdicts">
          <ng-container>
            <li *ngFor="let verdict of verdicts" class="verdict-item">
              <a href="#" (click)="openVerdict(verdict.caseName); $event.preventDefault()" class="verdict-link">
                <!--ime presude -->
                <div class="verdict-left">
                  <div class="icon-name">
                    <span class="verdict-icon">üìÑ</span>
                    <span class="verdict-name">{{ verdict.caseName }}</span>
                  </div>
                  <div class="verdict-similarity">
                    {{ verdict.similarity != null ? (verdict.similarity * 100 | number:'1.2-2') : '0.00' }}%
                  </div>
                </div>


                <!-- pravne cinjenice -->
                <div class="verdict-right">
                  <p class="column-title">Pravne ƒçinjenice:</p>
                  <div class="verdict-attributes">
                    <p *ngIf="verdict.acknowledged !== undefined">Priznao: {{ verdict.acknowledged ? 'DA' : 'NE' }}</p>
                    <p *ngIf="verdict.convicted !== undefined">Osuƒëivan: {{ verdict.convicted ? 'DA' : 'NE' }}</p>
                    <p *ngIf="verdict.maintenance !== undefined">Izdr≈æavanje: {{ verdict.maintenance ? 'DA' : 'NE' }}
                    </p>
                    <p *ngIf="verdict.repentance !== undefined">Kajanje: {{ verdict.repentance ? 'DA' : 'NE' }}</p>
                    <p *ngIf="verdict.previousFamilyIssues !== undefined">Prethodni porodiƒçni problemi: {{
                      verdict.previousFamilyIssues ? 'DA' : 'NE' }}</p>
                    <p *ngIf="verdict.correctBehavior !== undefined">Korektno dr≈æanje: {{ verdict.correctBehavior ? 'DA'
                      : 'NE' }}</p>
                    <p *ngIf="verdict.injuredCriminalProsecution !== undefined">O≈°teƒáeni goni kriviƒçno: {{
                      verdict.injuredCriminalProsecution ? 'DA' : 'NE' }}</p>
                    <p *ngIf="verdict.propertyClaim !== undefined">Imovinsko-pravni zahtev: {{ verdict.propertyClaim ?
                      'DA' : 'NE' }}</p>
                    <p *ngIf="verdict.intentional !== undefined">Sa umi≈°ljajem: {{ verdict.intentional ? 'DA' : 'NE' }}
                    </p>

                    <p *ngIf="verdict.financialStatus">Materijalno stanje: {{ verdict.financialStatus }}</p>
                    <p *ngIf="verdict.injuryType">Tip povrede: {{ verdict.injuryType }}</p>
                    <p *ngIf="verdict.accountability">Uraƒçunljivost: {{ verdict.accountability }}</p>


                    <!-- Rasudjivanje po pravilima -->
                    <p *ngIf="verdict.familyObligationsViolation">Kr≈°enje porodiƒçnih obaveza: {{
                      verdict.familyObligationsViolation }}</p>
                    <p *ngIf="verdict.extramaritalRelationshipMinor">Vanbraƒçna zajednica sa maloletnikom: {{
                      verdict.extramaritalRelationshipMinor }}</p>
                    <p *ngIf="verdict.unlawfulDetention">Nezakonito dr≈æanje ƒçlanova porodice: {{
                      verdict.unlawfulDetention }}</p>
                    <p *ngIf="verdict.familyMemberMaintenance">Nedavanje izdr≈æavanja: {{ verdict.familyMemberMaintenance
                      }}</p>
                    <p *ngIf="verdict.domesticViolence">Nasilje u porodici: {{ verdict.domesticViolence }}</p>


                  </div>
                  <span class="open-icon">üîó</span>
                </div>
              </a>
            </li>
          </ng-container>
        </ul>
      </div>
    </div>


    <div class="actions">
      <button class="fancy-btn"
        [disabled]="!metadata.caseName ||caseName.invalid || !metadata.court || !metadata.judge || !metadata.date || !metadata.defendant || !metadata.injuredParty || !metadata.clerk"
        (click)="executeReasoning()">‚öñÔ∏è IZVR≈†AVANJE RASUƒêIVANJA ‚öñÔ∏è</button>
    </div>
  </div>